<html>
  <body>
    <canvas id="canvas" height="500" width="500"></canvas>

    <script type="text/javascript">
      canvas = document.getElementById("canvas");
      ctx = canvas.getContext("2d");

      ctx.lineWidth = 1;

      ctx.strokeStyle = "rgba(255, 255, 255, 1.0)";
      ctx.beginPath();
      ctx.fillRect(0, 0, 500, 500);
      ctx.fill();

      var angle = 0;
      var angleInc = 0.05;
      var sizeIncr = 1;
      var minSize = 180;
      var maxSize = 250;
      var size = minSize;
      var leftPointX = 0
      var leftPointY = 250
      var rightPointX = 500 - leftPointX
      var rightPointY = leftPointY
      var x0 = 250;
      var way = 1;

      var count = 0
      var colors = [0, 0, 0]
      var saturation = 128

      function f(x){
        return parseInt(255*Math.sin(x*Math.PI))
      }

      function line(ctx, x1, y1, x2, y2){
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
      }

      function draw(){

        var y0 = 250-size/2;
        var backdelta = size/2/(x0-rightPointX)*(y0-rightPointY)
        count += 1;

        ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
        ctx.fillRect(0, 0, 500, 500);

        ctx.fillStyle = "rgba(0, 0, 0, 1)";

        //vline1
        ctx.beginPath();

        x = (count % 100) / 100
        red = f(x)
        green = f((x+1/3) % 1)
        blue = f((x+2/3) % 1)

        ctx.strokeStyle = "rgba("+red+", "+green+", "+blue+", 0.8)";

        x1 = 250 + Math.sin(angle) * size/2
        delta = (x1-x0)*1.0/(x0-rightPointX)*(y0-rightPointY)
        y1 = y0 + delta
        y2 = y0 - delta + size

        ctx.moveTo(x1, y1);
        ctx.lineTo(x1, y2);
        ctx.stroke();

        //vline2
        ctx.beginPath();
        x2 = 250 + Math.sin(angle+3*Math.PI/2) * size/2
        delta = (x2-x0)*1.0/(x0-leftPointX)*(y0-leftPointY)
        y3 = y0 + delta
        y4 = y0 - delta + size

        ctx.moveTo(x2, y3);
        ctx.lineTo(x2, y4);
        ctx.stroke();

        //vline3
        ctx.beginPath();
        x3 = 250 + Math.sin(angle+Math.PI) * size/2
        delta = (x3-x0+size/2)*1.0/(x0-size/2-rightPointX)*(y0 + backdelta - rightPointY)
        y5 = y0 + delta + backdelta
        y6 = y0 - delta - backdelta + size
        ctx.moveTo(x3, y5);
        ctx.lineTo(x3, y6);
        ctx.stroke();

        //vline4
        ctx.beginPath();
        x4 = 250 + Math.sin(angle+Math.PI/2) * size/2
        delta = (x4-x0-size/2)*1.0/(x0+size/2-leftPointX)*(y0 + backdelta - leftPointY)
        y7 = y0 + backdelta + delta
        y8 = y0 - delta - backdelta + size
        ctx.moveTo(x4, y7);
        ctx.lineTo(x4, y8);
        ctx.stroke();

        //hlines
        ctx.beginPath();

        line(ctx, x1, y1, x2, y3)
        line(ctx, x1, y2, x2, y4)
        line(ctx, x1, y1, x4, y7)
        line(ctx, x1, y2, x4, y8)
        line(ctx, x3, y5, x2, y3)
        line(ctx, x3, y6, x2, y4)
        line(ctx, x3, y5, x4, y7)
        line(ctx, x3, y6, x4, y8)

        angle = angle + angleInc
        size = size + way*sizeIncr

        if(angle > Math.PI/2){
          angle -= Math.PI/2
        }
        if(size > maxSize || size < minSize){
          way = -way;
        }
        requestAnimationFrame(draw)
      }

      draw()

    </script>
  </body>
</html>
